(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{100:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(57),m=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"formatURL",value:function(e){return e.replace(/^https?:\/\//i,"")}},{key:"render",value:function(){var e=this.props.account&&this.props.account.username&&this.props.account.member_since;return l.a.createElement("div",{className:"identity"},l.a.createElement("div",{className:"user"},l.a.createElement(u.a,{username:e&&this.props.account.username}),l.a.createElement("h1",null,e?this.props.account.real_name?this.props.account.real_name:this.props.account.username:l.a.createElement("span",{className:"placeholder"})),l.a.createElement("p",{className:"member-since"},e?l.a.createElement(l.a.Fragment,null,"Joined on ",new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit"}).format(new Date(this.props.account.member_since))):l.a.createElement("span",{className:"placeholder"}))),l.a.createElement("div",{className:"user-extended"},e&&this.props.account.bio&&l.a.createElement("p",{className:"bio"},this.props.account.bio),e&&this.props.account.website&&l.a.createElement("p",{className:"homepage"},l.a.createElement("a",{href:this.props.account.website},this.formatURL(this.props.account.website)))))}}]),t}(c.Component)},101:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(305),m=n(304),p=n(147),d=n(148),h=n(46),f=n.n(h),v={stroke:"#c2c2c2",strokeWidth:1},b={fontSize:"12px",color:"#3f3f3f"},E=function(e){return new Intl.DateTimeFormat("en-GB",{month:"short"}).format(new Date(e))},g=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"createEmptySeries",value:function(e,t){var n=new Array(e);return n.fill(0),n.reduce(function(e,t){var n=e[e.length-1];return e.push(n-6048e5),e},[t-6048e5]).reverse().map(function(e){return{timestamp:e,value:0}})}},{key:"padTimeseries",value:function(e){var t=e.length>0?e[0].timestamp:(new Date).getTime();return this.createEmptySeries(19-e.length,t).concat(e)}},{key:"computeChart",value:function(){var e=this.props.stats.over_time.map(function(e){return{timestamp:Date.parse(e.date),value:e.value}});return e.length<20?this.padTimeseries(e):e}},{key:"render",value:function(){return l.a.createElement("div",{className:this.props.className?"activity-widget ".concat(this.props.className):"activity-widget"},l.a.createElement("h2",null,"Activity",this.props.stats&&l.a.createElement("span",{className:"count"},l.a.createElement(f.a,{displayType:"text",value:this.props.stats.total_contributions,thousandSeparator:!0})," edits")),this.props.stats&&l.a.createElement(u.a,{width:this.props.width,height:this.props.height,barCategoryGap:1.5,data:this.computeChart()},l.a.createElement(m.a,{strokeDasharray:"3",horizontal:!1}),l.a.createElement(p.a,{type:"number",dataKey:"timestamp",axisLine:v,tick:b,tickSize:4,tickCount:6,tickLine:v,tickFormatter:E,height:20,domain:["dataMin","dataMax"],padding:{left:5,right:5}}),l.a.createElement(d.a,{dataKey:"value",fill:this.props.fill})))}}]),t}(c.Component)},102:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(14),m=n.n(u),p=n(57),d=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={collaborators:[]},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.fetchCollaborators()}},{key:"fetchCollaborators",value:function(){var e=this;this.props.username&&m.a.get("/api/account/".concat(this.props.username,"/collaborators")).then(function(t){return e.setState({collaborators:t.data})})}},{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,this.state.collaborators.length>0&&l.a.createElement("div",{className:this.props.className?"collaborator-list ".concat(this.props.className):"collaborator-list"},l.a.createElement("h2",null,this.props.title),l.a.createElement("ul",null,this.state.collaborators.map(function(e){return l.a.createElement("li",{key:e.username},l.a.createElement("a",{href:"/".concat(e.username),title:e.username},l.a.createElement(p.a,{username:e.username})))}))))}}]),t}(c.Component)},103:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(38),m=n(68),p=n(54),d=n(46),h=n.n(d),f=n(143),v=n.n(f),b=n(22),E=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).updateTotalRowSpan(e),n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.updateTotalRowSpan(e)}},{key:"updateTotalRowSpan",value:function(e){this._totalSpan=e.columns.reduce(function(e,t){return e+b.b.getSpan(t)},0)}},{key:"getWidth",value:function(e){return b.b.getSpan(e)/this._totalSpan}}]),t}(c.Component),g={TEXT_PLAIN:"icon_text.png",TEXT_TEIXML:"icon_tei.png",IMAGE_UPLOAD:"icon_image.png",IMAGE_IIIF:"icon_iiif.png",DATA_CSV:"icon_csv.png"},y={language:function(e){return e.toUpperCase()},uploaded_at:function(e){return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit"}).format(new Date(e))},last_edit_at:function(e){return l.a.createElement(v.a,{date:e})},public_visibility:function(e){return"PUBLIC"===e?l.a.createElement("span",{className:"icon",title:"Open to anyone"},"\uf09c"):"WITH_LINK"===e?l.a.createElement("span",{className:"icon",title:"Open to anyone with the link"},"\uf0c1"):l.a.createElement("span",{className:"icon",title:"Private"},"\uf023")},access_level:function(e){return"ADMIN"===e?l.a.createElement("span",{className:"icon",title:"ADMIN"},"\uf0ad"):"WRITE"===e?l.a.createElement("span",{className:"icon",title:"WRITE"},"\uf040"):l.a.createElement("span",{className:"icon",title:"READ"},"\uf06e")},annotations:function(e){return l.a.createElement(h.a,{displayType:"text",value:e,thousandSeparator:!0})},status_ratio:function(e){var t=e.verified+e.unverified+e.not_identifiable,n=e.verified/t*100,a=e.not_identifiable/t*100,o={verified:"verified",unverified:"unverified",not_identifiable:"flagged"},r=["verified","unverified","not_identifiable"].reduce(function(t,n){var a=e[n];return 0===a?t:"".concat(t," ").concat(a," ").concat(o[n],",")},"").slice(0,-1);return l.a.createElement("span",{className:"bar",title:r},l.a.createElement("span",{className:"verified",style:{width:"".concat(n,"%")}}),l.a.createElement("span",{className:"not_identifiable",style:{width:"".concat(a,"%")}}))}},C={agg_document:function(e){return e.author?"".concat(e.author,", ").concat(e.title):e.title}},O=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"createAggregateField",value:function(e,n){return l.a.createElement("a",{key:n,href:e,className:n.substring(4),style:{width:"".concat(100*Object(p.a)(Object(s.a)(t.prototype),"getWidth",this).call(this,n),"%")}},C[n](this.props.item))}},{key:"createField",value:function(e,n){var a=y[n],o=void 0!==this.props.item[n]?a?a(this.props.item[n]):this.props.item[n]:"";return l.a.createElement("a",{key:n,href:e,className:n,style:{width:"".concat(100*Object(p.a)(Object(s.a)(t.prototype),"getWidth",this).call(this,n),"%")}},o)}},{key:"render",value:function(){var e=this,t=this.props.item.filetypes[0],n="document/".concat(this.props.item.id,"/part/1/edit");return l.a.createElement("div",{className:"row".concat(this.props.selected?" selected":""),style:this.props.style,onClick:this.props.onClick},this.props.columns.map(function(t){return t.startsWith("agg_")?e.createAggregateField(n,t):e.createField(n,t)}),l.a.createElement("span",{className:"type icon ".concat(t)},l.a.createElement("img",{src:"/assets/images/".concat(g[t]),alt:"icon type ".concat(t)})))}}]),t}(E),k=n(58),S=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={title:n.props.item.title,editable:!1},n.makeEditable=function(e){n.setState({editable:!0},function(){return n._input.select()}),e.preventDefault(),e.stopPropagation()},n.onChange=function(e){n.setState({title:e.target.value})},n.onKeyPress=function(e){13===e.which&&n.setState({editable:!1},function(){return n.props.onRename(n.props.item,n.state.title)})},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({title:e.item.title,editable:!1})}},{key:"render",value:function(){var e=this;return l.a.createElement("a",{href:"#".concat(this.props.item.id),style:this.props.style,className:"row folder".concat(this.props.selected?" selected":""),onClick:this.props.onClick},l.a.createElement("span",{className:"folder-title"},this.state.editable?l.a.createElement("input",{ref:function(t){return e._input=t},value:this.state.title,onClick:this.makeEditable,onChange:this.onChange,onKeyDown:this.onKeyPress}):l.a.createElement("span",{className:"editable",onClick:this.makeEditable},this.state.title)),l.a.createElement("span",{className:"type icon"},"\uf07b"))}}]),t}(c.Component),N=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"column-labels"},this.props.columns.map(function(n){return l.a.createElement("span",{key:n,style:{width:"".concat(100*Object(p.a)(Object(s.a)(t.prototype),"getWidth",e).call(e,n),"%")},className:"label ".concat(n),onClick:e.props.onSort.bind(e,n)},l.a.createElement("span",{className:"inner-wrapper"},l.a.createElement("span",{className:"inner"},b.c[n]||n),e.props.sortColumn===n&&l.a.createElement("span",{className:"sort icon"},l.a.createElement("span",{className:"inner"},e.props.sortAsc?"\ue688":"\ue682"))))}))}}]),t}(E),w=n(53),j=n(45),_=Object(w.SortableElement)(function(e){var t=e.label;return l.a.createElement("div",{className:"card"},t)}),D=Object(w.SortableContainer)(function(e){var t=e.items;return l.a.createElement("div",{className:"column-order"},t.map(function(e,t){return l.a.createElement(_,{key:"card-".concat(t),index:t,label:b.c[e]})}))}),A=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement(D,{items:this.props.items,onSortEnd:function(t){return e.props.onSortEnd(t.oldIndex,t.newIndex)}})}}]),t}(c.Component),I=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).state={columns:e.columns.slice(0)},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.columns!==this.props.columns&&this.setState({columns:e.columns.slice(0)})}},{key:"getCheckboxStates",value:function(e){var t=this,n={};return b.a.forEach(function(e){var a=t.state.columns.includes(e);n[e]=a}),n}},{key:"setAllRows",value:function(e){var t=this;e?function(){var e=b.a.filter(function(e){return!t.state.columns.includes(e)});t.setState({columns:t.state.columns.concat(e)})}():t.setState({columns:[]})}},{key:"onClickAll",value:function(){b.a.length===this.state.columns.length?this.setAllRows(!1):this.setAllRows(!0)}},{key:"toggleOne",value:function(e){this.setState(function(t){var n=t.columns.indexOf(e);return n<0?t.columns.push(e):t.columns.splice(n,1),t})}},{key:"onSort",value:function(e,t){this.setState({columns:Object(w.arrayMove)(this.state.columns,e,t)})}},{key:"render",value:function(){var e=this;return l.a.createElement(j.a,{className:"preferences",title:"Configure Columns",onClose:this.props.onCancel},l.a.createElement("div",{className:"scroll-pane"},l.a.createElement("div",{className:"selected-columns"},l.a.createElement("button",{className:"all nostyle",onClick:this.onClickAll.bind(this)},"All"),l.a.createElement("ul",null,b.a.map(function(t){return l.a.createElement("li",{key:t},l.a.createElement("input",{type:"checkbox",id:t,name:t,checked:e.state.columns.includes(t),onChange:e.toggleOne.bind(e,t)}),l.a.createElement("label",{htmlFor:t},b.c[t]))}))),l.a.createElement(A,{items:this.state.columns,onSortEnd:this.onSort.bind(this)})),l.a.createElement("div",{className:"buttons"},l.a.createElement("button",{className:"btn",onClick:this.props.onSave.bind(this,this.state.columns)},"Save"),l.a.createElement("button",{className:"btn outline",onClick:this.props.onCancel},"Cancel")))}}]),t}(c.Component);n.d(t,"a",function(){return M});var M=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={drag:!1,tablePreferencesOpen:!1},n.showPreferences=function(e){n.setState({tablePreferencesOpen:e})},n.onSavePreferences=function(e){n.setState({tablePreferencesOpen:!1}),n.props.onChangeColumnConfig(e)},n.sortBy=function(e){var t=n.props.config.sorting.by!==e||!n.props.config.sorting.asc;n.props.onSort({by:e,asc:t})},n.onDrag=function(e){n.setState({drag:e})},n.onDrop=function(e,t,a){var o=a.dataTransfer.getData("URL"),r=o?function(){var e=document.createElement("a");return e.href=o,e.hostname}():null;n.setState({drag:!1}),e.length>0?n.props.onDropFiles(e):o&&r!==window.location.hostname&&n.props.onDropSourceURL(o)},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"rowRenderer",value:function(){var e=this;return function(t){var n=e.props.items[t.index],a=e.props.selection&&e.props.selection.includes(n);return"FOLDER"===n.type?l.a.createElement(S,{key:t.key,style:t.style,item:n,selected:a,onClick:function(a){return e.onRowClick(a,n,t.index)},onRename:e.props.onRenameFolder}):l.a.createElement(O,{key:t.key,style:t.style,columns:e.props.config.columns,item:n,selected:a,onClick:function(a){return e.onRowClick(a,n,t.index)}})}}},{key:"onRowClick",value:function(e,t,n){var a=this.props.selection&&this.props.selection.handleClick(e,t,n,this.props.items);a&&this.props.onSelect(a)}},{key:"render",value:function(){var e=this,t=l.a.createElement("div",{className:"documents-pane table-pane"},l.a.createElement(u.a,null,function(t){var n=t.height,a=t.width;return l.a.createElement(u.b,{className:"virtualized-list",width:a,height:n,rowCount:e.props.items.length,rowHeight:47,rowRenderer:e.rowRenderer()})}),this.state.drag&&l.a.createElement(k.a,null),this.props.busy&&l.a.createElement("div",{className:"busy-mask"}));return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"documents-table-header"},l.a.createElement(N,{columns:this.props.config.columns,sortColumn:this.props.config.sorting.by,sortAsc:this.props.config.sorting.asc,onSort:this.sortBy}),l.a.createElement("button",{className:"column-options-btn nostyle icon",onClick:function(){return e.showPreferences(!0)}},"\uf141")),this.props.enableFiledrop?l.a.createElement(m.a,{className:"dropzone",disableClick:!0,onDragEnter:function(){return e.onDrag(!0)},onDragLeave:function(){return e.onDrag(!1)},onDrop:this.onDrop},t):t,this.state.tablePreferencesOpen&&l.a.createElement(I,{columns:this.props.config.columns,onCancel:function(){return e.showPreferences(!1)},onSave:this.onSavePreferences}))}}]),t}(c.Component)},104:function(e,t,n){"use strict";var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(68),m=n(38),p=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.filetypes[0],t=this.props.fileCount>1;return l.a.createElement("a",{href:"document/".concat(this.props.id,"/part/1/edit"),className:"cell".concat(this.props.selected?" selected":""),onClick:this.props.onClick},l.a.createElement("div",{className:"inner"},l.a.createElement("div",{className:"item-wrapper".concat(t?" stacked":"")},t&&l.a.createElement("div",{className:"stack"}),l.a.createElement("div",{className:"document ".concat(e)},l.a.createElement("div",{className:"label"},this.props.title)))))}}]),t}(c.Component),d=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement("a",{href:"#".concat(this.props.id),className:"cell".concat(this.props.selected?" selected":""),onClick:this.props.onClick},l.a.createElement("div",{className:"inner"},l.a.createElement("div",{className:"item-wrapper"},l.a.createElement("div",{className:"folder"},l.a.createElement("div",{className:"label"},this.props.title)))))}}]),t}(c.Component),h=n(58);n.d(t,"a",function(){return f});var f=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={drag:!1},n.onDrag=function(e){n.setState({drag:e})},n.onDrop=function(e,t,a){var o=a.dataTransfer.getData("URL");n.setState({drag:!1}),e.length>0?n.props.onDropFiles(e):o&&n.props.onDropSourceURL(o)},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"onTileClick",value:function(e,t,n){var a=this.props.selection&&this.props.selection.handleClick(e,t,n,this.props.items);a&&this.props.onSelect(a)}},{key:"rowRenderer",value:function(e){var t=this;return function(n){var a=n.index*e,o=Math.min(a+e,t.props.items.length)-a,r=new Array(o).fill(void 0).map(function(e,n){var o=n+a,r=t.props.items[o],s=t.props.selection&&t.props.selection.includes(r);return"FOLDER"===r.type?l.a.createElement(d,{key:o,id:r.id,title:r.title,selected:s,onClick:function(e){return t.onTileClick(e,r,o)}}):l.a.createElement(p,{key:o,id:r.id,title:r.title,filetypes:r.filetypes,fileCount:r.file_count,selected:s,onClick:function(e){return t.onTileClick(e,r,o)}})});return o<e&&r.push(new Array(e-o).fill(void 0).map(function(e,t){return l.a.createElement("div",{className:"cell dummy",key:"dummy-".concat(t)})})),l.a.createElement("div",{key:n.key,style:n.style,className:"row"},r)}}},{key:"render",value:function(){var e=this,t=l.a.createElement(m.a,null,function(t){var n=t.height,a=t.width,o=Math.floor(a/192),r=Math.ceil(e.props.items.length/o);return l.a.createElement(m.b,{className:"virtualized-grid",width:a,height:n,rowCount:r,rowHeight:192,rowRenderer:e.rowRenderer(o)})});return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"documents-pane grid-pane"},this.props.disableFiledrop?t:l.a.createElement(u.a,{className:"dropzone",disableClick:!0,onDragEnter:function(){return e.onDrag(!0)},onDragLeave:function(){return e.onDrag(!1)},onDrop:this.onDrop},t),this.state.drag&&l.a.createElement(h.a,null)))}}]),t}(c.Component)},22:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return u});var a=n(4),o=n(5),r=["owner","shared_by","access_level"],s=["author","title","language","date_freeform","uploaded_at","last_edit_at","last_edit_by","annotations","public_visibility","status_ratio"].concat(r),i={author:"Author",title:"Title",language:"Language",date_freeform:"Date",uploaded_at:"Uploaded at",last_edit_at:"Last edit",last_edit_by:"Last edit by",annotations:"Annotations",public_visibility:"Visibility",status_ratio:"Verification ratio",activity:"Activity graph",owner:"Document owner",shared_by:"Shared by",access_level:"Access"},c={agg_document:"XL",author:"M",title:"L",language:"M",date_freeform:"M",uploaded_at:"M",last_edit_at:"M",last_edit_by:"M",annotations:"M",public_visibility:"M",status_ratio:"M",activity:"M",owner:"M",shared_by:"M",access_level:"M"},l={agg_document:["author","document"]},u=function(){function e(){Object(a.a)(this,e)}return Object(o.a)(e,null,[{key:"getSpan",value:function(e){var t=c[e];return"XL"===t?6:"L"===t?4:"M"===t?2:"S"===t?1:void 0}},{key:"expandAggregatedColumns",value:function(e){return e.reduce(function(e,t){return t.startsWith("agg_")?e=e.concat(l[t]):e.push(t),e},[])}},{key:"filterByView",value:function(e,t){return"MY_DOCUMENTS"===t?e.filter(function(e){return!r.includes(e)}):e}}]),e}()},307:function(e,t,n){e.exports=n(662)},37:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(4),o=n(5),r=function(){function e(t){var n=this;Object(a.a)(this,e),this.selectItem=function(t,a){if(a){var o=n._selection.indexOf(t),r=o>-1,s=n._selection.slice(0);return r?s.splice(o,1):s.push(t),new e(s)}return new e([t])},this.selectRange=function(t,a){var o=n._selection.map(function(e){return t.indexOf(e)}),r=Math.min.apply(null,o),s=Math.max.apply(null,o),i=a>s||a<r,c=function(e,n){return t.slice(e,n+1)};return new e(i&&a>s?c(r,a):i?c(a,s):c(r,a))},this._selection=t||[]}return Object(o.a)(e,[{key:"isEmpty",value:function(){return 0===this._selection.length}},{key:"includes",value:function(e){return this._selection.includes(e)}},{key:"isSingleSelection",value:function(){return 1===this._selection.length}},{key:"isSingleFolder",value:function(){return 1===this._selection.length&&"FOLDER"===this._selection[0].type}},{key:"isSingleDocument",value:function(){return 1===this._selection.length&&"DOCUMENT"===this._selection[0].type}},{key:"includesText",value:function(){return this._selection.filter(function(e){return e.filetypes&&e.filetypes.find(function(e){return e.startsWith("TEXT")})}).length>0}},{key:"get",value:function(e){return this._selection[e]}},{key:"getItems",value:function(){return this._selection}},{key:"handleClick",value:function(e,t,n,a){var o=e.getModifierState("Shift"),r=e.getModifierState("Control");if(o||r||!this.includes(t)){var s=o?this.selectRange(a,n):this.selectItem(t,r);return e.preventDefault(),s}}}]),e}()},45:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(66),m=n.n(u),p=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"clicktrap ".concat(this.props.className)},l.a.createElement("div",{className:"modal-wrapper"},l.a.createElement(m.a,{handle:".modal-header"},l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("h1",{className:"title"},this.props.title),l.a.createElement("button",{className:"close nostyle",onClick:this.props.onClose},"\ue897")),l.a.createElement("div",{className:"modal-body"},this.props.children)))))}}]),t}(c.Component)},57:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"stringToHslColor",value:function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t%360}},{key:"render",value:function(){var e=this.props.username?"hsl(".concat(this.stringToHslColor(this.props.username),", 35%, 65%)"):"#e2e2e2";return l.a.createElement("div",{className:"avatar",style:{backgroundColor:e}},l.a.createElement("div",{className:"inner"},this.props.username&&this.props.username.charAt(0).toUpperCase()))}}]),t}(c.Component)},58:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(144).a.div({open:{bottom:"30px",transition:{ease:"easeOut",duration:200}},closed:{bottom:"-140px"}}),m=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={visible:!1},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({visible:!0})}},{key:"render",value:function(){return l.a.createElement("div",{className:"filedrop-hint"},l.a.createElement(u,{className:"inner",pose:this.state.visible?"open":"closed"},l.a.createElement("span",{className:"icon"},"\uf0ee"),l.a.createElement("p",{className:"instructions"},"Drop files or IIIF manifest URLs to add them to your workspace."),l.a.createElement("p",{className:"supported"},"Supported formats: plain text (UTF-8), TEI/XML, image files, CSV (UTF-8)")))}}]),t}(c.Component)},657:function(e,t,n){},662:function(e,t,n){"use strict";n.r(t);var a=n(25),o=n(4),r=n(5),s=n(7),i=n(3),c=n(6),l=n(0),u=n.n(l),m=n(15),p=n(14),d=n.n(p),h=n(22),f=n(37),v={account:null,view:"MY_DOCUMENTS",presentation:"TABLE",page:{breadcrumbs:null,readme:null,total_count:0,items:[]},selection:new f.a,table_config:{columns:["author","title","language","date_freeform","uploaded_at","last_edit_at"],sorting:{by:null,asc:!0}},busy:!0,runningTasks:[]},b=function(){var e={};return["view","presentation","table_config"].map(function(t){var n=localStorage.getItem("recogito.workspace.".concat(t));n&&(e[t]=JSON.parse(n))}),Object(a.a)({},v,e)},E=function(e,t){var n="recogito.workspace.".concat(e);localStorage.setItem(n,JSON.stringify(t))},g=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).handleKeydown=function(e){27===e.which&&n.props.onCancel()},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown,!1)}},{key:"render",value:function(){return u.a.createElement("div",{className:"clicktrap ".concat(this.props.className)},u.a.createElement("div",{className:"modal-wrapper modal-form-wrapper ".concat(this.props.className)},u.a.createElement("div",{className:"modal"},u.a.createElement("div",{className:"modal-inner"},u.a.createElement("div",null,this.props.children),u.a.createElement("div",{className:"footer"},u.a.createElement("button",{className:"btn outline tiny",onClick:this.props.onCancel},"Cancel"),u.a.createElement("button",{className:"btn tiny",onClick:this.props.onOk},"Ok"))))))}}]),t}(l.Component),y=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={folderName:""},n.onChange=function(e){n.setState({folderName:e.target.value})},n.onKeyPress=function(e){13===e.which&&n.onOk()},n.onOk=function(){n.props.onOk(n.state.folderName)},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement(g,{onOk:this.onOk,onCancel:this.props.onCancel},u.a.createElement("input",{type:"text",autoFocus:!0,placeholder:"Folder name",value:this.state.folderName,onChange:this.onChange,onKeyPress:this.onKeyPress}))}}]),t}(l.Component),C=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"meter",style:{position:"relative"}},u.a.createElement("div",{className:"bar",style:{width:"".concat(100*this.props.value,"%"),height:"100%"}}))}}]),t}(l.Component),O=function(e){return u.a.createElement("li",null,e.upload.file.name,u.a.createElement("span",{className:"icon spinner ".concat(e.upload.status)}))},k=function(e){var t=e.uploads.reduce(function(e,t){return e+t.progress},0),n=e.uploads.reduce(function(e,t){return t.error&&e.push(t.error),e},[]);return u.a.createElement("div",{className:"upload-progress"},u.a.createElement("div",{className:"phase"},e.phase,u.a.createElement("button",{className:"close nostyle",onClick:e.onClose},"\ue897")),u.a.createElement("ul",{className:"files".concat(n.length>0?" has-errors":"")},e.uploads.map(function(e){return u.a.createElement(O,{key:e.file.name,upload:e})}),0===e.uploads.length&&u.a.createElement("li",null,"Fetching content from remote source...",u.a.createElement("span",{className:"icon spinner RUNNING"}))),n.length>0&&u.a.createElement("ul",{className:"errors"},u.a.createElement("li",null,n.join())),u.a.createElement("div",{className:"progress"},u.a.createElement(C,{value:t/e.totalSize})))},S=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).updateUploadState=function(e,t){n.setState(function(n){return{uploads:n.uploads.map(function(n){return n.file===e.file?Object(a.a)({},n,t):n})}})},n.initNewDocument=function(){var e=1===n.state.uploads.length?n.state.uploads[0].file.name:"New document",t=new FormData;return t.append("title",e),d.a.post("/my/upload",t,{headers:{"X-Requested-With":"XMLHttpRequest"}})},n.uploadFiles=function(){var e=n.state.uploads.map(function(e){var t=new FormData;t.append("file",e.file);return d.a.post("/my/upload/".concat(n.state.uploadId,"/file"),t,{headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:function(t){n.updateUploadState(e,{progress:t.loaded})}}).then(function(t){return n.updateUploadState(e,{filepartId:t.data.uuid}),t}).catch(function(t){throw n.updateUploadState(e,{status:"FAILED",error:t.response.data}),t})});return Promise.all(e)},n.finalizeDocument=function(e){var t=document.location.hash.substring(1),a=t?"/my/upload/".concat(n.state.uploadId,"/finalize?folder=").concat(t):"/my/upload/".concat(n.state.uploadId,"/finalize");return d.a.post(a,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(t){var a=t.data.running_tasks;a&&a.length>0?(n.setState({phase:"Importing..."}),n.pollTaskProgress(t.data.document_id,a)):(n.setState({phase:"Completed"}),n.state.uploads.forEach(function(e){"FAILED"!==e.status&&n.updateUploadState(e,{status:"COMPLETED"})}),e||n.props.onComplete())})},n.pollTaskProgress=function(e,t){d.a.get("/api/job?id=".concat(e)).then(function(a){n.state.uploads.forEach(function(e){var t=a.data.subtasks.find(function(t){return t.filepart_id===e.filepartId});t?n.updateUploadState(e,{status:t.status}):n.updateUploadState(e,{status:"COMPLETED"})}),n.state.uploads.reduce(function(e,t){return e&&"COMPLETED"===t.status},!0)?(n.setState({phase:"Completed"}),n.props.onComplete()):setTimeout(function(){return n.pollTaskProgress(e,t)},1e3)}).catch(function(a){404===a.response.status&&setTimeout(function(){return n.pollTaskProgress(e,t)},1e3)})},n.state=n.initialState(e),n.start(),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"initialState",value:function(e){return{phase:"Uploading",totalSize:e.files.reduce(function(e,t){return t.size+e},0),uploadId:null,uploads:e.files.map(function(e){return{file:e,filepartId:null,status:"UPLOADING",progress:0,error:null}}),error:null}}},{key:"componentWillReceiveProps",value:function(e){this.setState(this.initialState(e))}},{key:"importRemoteSource",value:function(){this.setState({phase:"Importing"});var e=new FormData;return e.append("url",this.props.remoteSource.url),e.append("type",this.props.remoteSource.sourceType),d.a.post("/my/upload/".concat(this.state.uploadId,"/file"),e,{headers:{"X-Requested-With":"XMLHttpRequest"}})}},{key:"start",value:function(){var e=this;this.initNewDocument().then(function(t){return e.setState({uploadId:t.data.id}),e.props.remoteSource?e.importRemoteSource():e.uploadFiles()}).then(this.finalizeDocument).catch(function(t){throw e.setState({error:t}),e.finalizeDocument(!0),t})}},{key:"render",value:function(){return u.a.createElement(k,{phase:this.state.phase,totalSize:this.state.totalSize,uploads:this.state.uploads,error:this.state.error,onClose:this.props.onClose})}}]),t}(l.Component),N=n(280),w=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).SHINEFileUpload=function(e){var t=[];e.forEach(function(e){var n=new File([e.content],"".concat(e.name||"rise_file",".txt"),{type:"text/plain"});t.push(n)}),n.props.onUploadFiles(t)},n.handleSHINEModalClick=function(e){"shinemodal"===e.target.id&&n.props.onClose()},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{style:j.shineModal,id:"shinemodal",onClick:this.handleSHINEModalClick},u.a.createElement("div",{style:j.shineBrowserContainer},u.a.createElement(N.a,{styles:{primary:"#4483C4",borderRadius:2,fontFamily:"Assistant",text:"#3f3f3f"},close:this.props.onClose,handleFileUpload:this.SHINEFileUpload})))}}]),t}(l.Component),j={shineModal:{position:"fixed",backgroundColor:"rgba(0,0,0,.5)",zIndex:100,top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},shineBrowserContainer:{maxHeight:800,maxWidth:1200,margin:20,width:"100%",height:"100%",boxShadow:"0 .5rem 1rem rgba(0,0,0,.35)"}},_=w,D=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={url:""},n.onChange=function(e){n.setState({url:e.target.value})},n.onDrop=function(e){var t=e.dataTransfer.getData("text");n.setState({url:t})},n.onKeyPress=function(e){13===e.which&&n.onOk()},n.onOk=function(){n.props.onOk(n.state.url)},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement(g,{onOk:this.onOk,onCancel:this.props.onCancel},u.a.createElement("input",{type:"text",autoFocus:!0,placeholder:"Paste or drag URL",value:this.state.url,onChange:this.onChange,onDrop:this.onDrop,onKeyPress:this.onKeyPress}))}}]),t}(l.Component),A=function(e,t){return new Promise(function(n){var a=document.createElement("div");document.body.appendChild(a);Object(m.render)(u.a.createElement(S,{files:e,remoteSource:t,onComplete:function(){a.remove(),n()},onClose:function(e){a.remove()}}),a)})},I=function(e){return A(e)},M=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).state={status:"PENDING",progress:0,tasks:0,tasksCompleted:0},n.pollProgress(),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"pollProgress",value:function(){var e=this;d.a.get("/api/job/".concat(this.props.jobId)).then(function(t){e.setState({status:t.data.status,progress:t.data.progress,tasks:t.data.subtasks.length,tasksCompleted:t.data.subtasks.filter(function(e){return"COMPLETED"===e.status}).length,tasksFailed:t.data.subtasks.filter(function(e){return"FAILED"===e.status}).length}),"COMPLETED"===t.data.status||"FAILED"===t.data.status?e.props.onComplete&&e.props.onComplete():setTimeout(function(){return e.pollProgress()},1e3)}).catch(function(t){404===t.response.status&&setTimeout(function(){return e.pollProgress()},1e3)})}},{key:"render",value:function(){var e="COMPLETED"===this.state.status||"FAILED"===this.state.status;return u.a.createElement("div",{className:"job-progress"},u.a.createElement("div",{className:"header"},"Named Entity Recognition ",e&&u.a.createElement("button",{className:"close nostyle",onClick:this.props.onClose},"\ue897")),u.a.createElement("div",{className:"body"},u.a.createElement("div",{className:"message"},"Parsed ",this.state.tasksCompleted," of ",this.state.tasks," files",u.a.createElement("span",{className:"icon spinner ".concat(this.state.status)})),u.a.createElement("div",{className:"progress"},u.a.createElement(C,{value:this.state.progress/100}))))}}]),t}(l.Component),L=n(45),R=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"onChange",value:function(e){var t=this.props.selected,n=t.indexOf(e);n<0?t.push(e):t.splice(n,1),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"authorities"},u.a.createElement("h2",null,"Authority Files"),u.a.createElement("input",{type:"checkbox",id:"use-all-authorities",checked:this.props.useAll,onChange:this.props.onToggleAll}),u.a.createElement("label",{htmlFor:"use-all-authorities"},"identify entities against all available authority files"),u.a.createElement("div",{className:"authority-list".concat(this.props.useAll?" disabled":"")},u.a.createElement("table",null,u.a.createElement("tbody",null,this.props.authorities.map(function(t){return u.a.createElement("tr",{key:t.identifier},u.a.createElement("td",null,u.a.createElement("input",{type:"checkbox",id:t.identifier,checked:e.props.selected.includes(t.identifier),onChange:e.onChange.bind(e,t.identifier)}),u.a.createElement("label",{htmlFor:t.identifier})),u.a.createElement("td",{className:"shortname"},u.a.createElement("span",{style:{backgroundColor:t.color}},t.homepage?u.a.createElement("a",{href:t.homepage,target:"_blank",rel:"noopener noreferrer"},t.shortname):t.shortname)),u.a.createElement("td",{className:"fullname"},t.fullname))})))))}}]),t}(l.Component),T=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"engines"},u.a.createElement("h2",null,"Recognition Engines"),u.a.createElement("table",{cellSpacing:"0"},u.a.createElement("tbody",null,this.props.engines.map(function(t,n){return u.a.createElement(u.a.Fragment,{key:n},u.a.createElement("tr",null,u.a.createElement("td",{className:"name"},u.a.createElement("input",{id:t.identifier,type:"radio",group:"engines",checked:e.props.selected===t.identifier,onChange:e.props.onChange.bind(e,t.identifier)}),u.a.createElement("label",{htmlFor:t.identifier},u.a.createElement("span",{className:"name"},t.name))),u.a.createElement("td",{className:"languages"},t.languages.map(function(e){return u.a.createElement("span",{key:e},e)})),u.a.createElement("td",{className:"description"},t.description)),u.a.createElement("tr",{className:"spacer"}))}))),u.a.createElement("p",{className:"note"},"Note: different engines can provide different results and are generally optimized for a specific language."))}}]),t}(l.Component),F=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).state={available_engines:[],available_authorities:[],selected_engine:null,selected_all_authorities:!0,selected_authorities:[]},n.initAvailableAuthorities(),n.initAvailableEngines(),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"isInitComplete",value:function(){return this.state.available_engines.length>0&&this.state.available_authorities.length>0}},{key:"initAvailableEngines",value:function(){var e=this;0===this.state.available_engines.length&&d.a.get("/api/plugins/ner").then(function(t){var n={available_engines:t.data};e.state.selected_engine||(n.selected_engine=t.data[0]&&t.data[0].identifier),e.setState(n)})}},{key:"initAvailableAuthorities",value:function(){var e=this;d.a.get("/api/authorities/gazetteers").then(function(t){var n={available_authorities:t.data};(e.state.selected_all_authorities||!e.state.selected_all_authorities&&0===e.state.selected_authorities.length)&&(n.selected_authorities=t.data.map(function(e){return e.identifier})),e.setState(n)})}},{key:"changeEngine",value:function(e){this.setState({selected_engine:e})}},{key:"toggleAllAuthorities",value:function(){this.setState(function(e){return{selected_all_authorities:!e.selected_all_authorities}})}},{key:"changeAuthorities",value:function(e){this.setState({selected_authorities:e})}},{key:"onStart",value:function(){var e={engine:this.state.selected_engine};this.state.selected_all_authorities?e.all_authorities=!0:e.authorities=this.state.selected_authorities,this.props.onStart(e)}},{key:"render",value:function(){return u.a.createElement(L.a,{className:"ner",title:"Named Entity Recognition (NER)",onClose:this.props.onCancel},u.a.createElement("p",null,"NER identifies places and persons in your text automatically. Depending on the length of your text, this may take a while."),u.a.createElement(T,{engines:this.state.available_engines,selected:this.state.selected_engine,onChange:this.changeEngine.bind(this)}),u.a.createElement(R,{authorities:this.state.available_authorities,useAll:this.state.selected_all_authorities,selected:this.state.selected_authorities,onToggleAll:this.toggleAllAuthorities.bind(this),onChange:this.changeAuthorities.bind(this)}),u.a.createElement("div",{className:"buttons"},u.a.createElement("button",{className:"btn start",onClick:this.onStart.bind(this)},"Start NER"),u.a.createElement("button",{className:"btn outline cancel",onClick:this.props.onCancel},"Cancel")))}}]),t}(l.Component),P=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={running:!1,jobId:null},n.start=function(e){var t=n.props.selection.getItems().filter(function(e){var t="DOCUMENT"===e.type,n=e.filetypes.filter(function(e){return e.startsWith("TEXT")}).length>0;return t&&n}),o=Object(a.a)({},{task_type:"NER",documents:t.map(function(e){return e.id})},e);d.a.post("/api/job",o).then(function(e){n.setState({running:!0,jobId:e.data.job_id})})},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return this.state.running?u.a.createElement(M,{jobId:this.state.jobId,onComplete:this.props.onComplete,onClose:this.props.onClose}):u.a.createElement(F,{onStart:this.start,onCancel:this.props.onCancel})}}]),t}(l.Component),U=function(){var e=document.location.hash.substring(1);return e?"/api/folder/".concat(e,"/readme"):"/api/directory/my/readme"},x=n(66),K=n.n(x),V=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).onKeydown=function(e){27===e.which&&n.props.onNo()},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"render",value:function(){var e=this.props.type?"prompt ".concat(this.props.type.toLowerCase()):"prompt";return u.a.createElement("div",{className:"clicktrap"},u.a.createElement(K.a,{handle:".prompt-header"},u.a.createElement("div",{className:e},u.a.createElement("div",{className:"prompt-header"},u.a.createElement("h1",{className:"title"},this.props.title)),u.a.createElement("div",{className:"prompt-body"},u.a.createElement("p",{className:"message"},this.props.message),u.a.createElement("p",{className:"buttons"},u.a.createElement("button",{className:"btn yes",onClick:this.props.onYes},"YES"),u.a.createElement("button",{className:"btn outline no",onClick:this.props.onNo},"NO"))))))}}]),t}(l.Component),W=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).onKeydown=function(e){27===e.which&&n.props.onClose()},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"render",value:function(){var e=this.props.type?"prompt ".concat(this.props.type.toLowerCase()):"prompt";return u.a.createElement("div",{className:"clicktrap"},u.a.createElement(K.a,{handle:".prompt-header"},u.a.createElement("div",{className:e},u.a.createElement("div",{className:"prompt-header"},u.a.createElement("h1",{className:"title"},this.props.title)),u.a.createElement("div",{className:"prompt-body"},u.a.createElement("p",{className:"message"},this.props.message),u.a.createElement("p",{className:"buttons"},u.a.createElement("button",{className:"btn",onClick:this.props.onClose},"Close"))))))}}]),t}(l.Component),B=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={visibility:"PRIVATE",access_level:"READ_ALL"},n.updateSetting=function(e){n.setState(e,function(){d.a.post("/api/sharing/folders/visibility",Object(a.a)({},n.state,{ids:[n.props.item.id]})).catch(function(e){})})},n.onChangeVisibility=function(e){n.updateSetting({visibility:e})},n.onChangeAccessLevel=function(e){n.updateSetting({access_level:e.target.value})},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.a.get("/api/sharing/folders/".concat(this.props.item.id,"/visibility")).then(function(t){var n=t.data,a=n.visibility,o=n.access_level;e.setState({visibility:a,access_level:o||"READ_ALL"})})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"public-access"},u.a.createElement("div",{className:"multi-share-section"},u.a.createElement("h3",null,"Enable Public Access"),u.a.createElement("div",null,u.a.createElement("input",{type:"radio",name:"public-access",id:"pa-off",checked:"PRIVATE"===this.state.visibility,onChange:function(){return e.onChangeVisibility("PRIVATE")}}),u.a.createElement("label",{htmlFor:"pa-off"},"Off"),u.a.createElement("p",null,"Only people you explicitly add as collaborators have access.")),u.a.createElement("div",null,u.a.createElement("input",{type:"radio",name:"public-access",id:"pa-public",checked:"PUBLIC"===this.state.visibility,onChange:function(){return e.onChangeVisibility("PUBLIC")}}),u.a.createElement("label",{htmlFor:"pa-public"},"Anyone on the Web"),u.a.createElement("p",null,"Public documents are listed on your profile page, and anyone on the Internet can find them.")),u.a.createElement("div",null,u.a.createElement("input",{type:"radio",name:"public-access",id:"pa-with-link",checked:"WITH_LINK"===this.state.visibility,onChange:function(){return e.onChangeVisibility("WITH_LINK")}}),u.a.createElement("label",{htmlFor:"pa-with-link"},"Anyone with the Link"),u.a.createElement("p",null,"Accessible to anyone who has the link, but it is not listed on your profile page."))),u.a.createElement("div",{className:"multi-share-section"},u.a.createElement("strong",null,"Access:")," anyone can",u.a.createElement("select",{value:this.state.access_level,onChange:this.onChangeAccessLevel},u.a.createElement("option",{value:"READ_ALL"},"view"),u.a.createElement("option",{value:"READ_DATA"},"view map and downloads but not document content"),u.a.createElement("option",{value:"WRITE"},"annotate")),u.a.createElement("p",null,"Annotating requires a Recogito account. Visitors who are not logged in can view documents (if enabled), and download annotations from the download page. But they cannot add annotations, even when public annotation is enabled. Blocking access to document content will also limit some of the download options.")))}}]),t}(l.Component),H=n(303),G=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).onMousedown=function(e){!n._node.contains(e.target)&&n.props.onCancel()},n.onKeydown=function(e){e.stopPropagation(),27===e.which&&n.props.onCancel()},n.handleCancel=function(){n.props.onCancel()},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMousedown,!1),document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMousedown,!1),document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"changeLevel",value:function(e){this.props.onChangeLevel(e)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"permission-selector",ref:function(t){return e._node=t}},u.a.createElement("h3",null,"Permission Level",u.a.createElement("span",{className:"close outline-icon",onClick:this.handleCancel},"\ue897")),u.a.createElement("ul",null,u.a.createElement("li",{className:"READ",onClick:function(){return e.changeLevel("READ")}},u.a.createElement("div",{className:"checked"},u.a.createElement("div",{className:"icon"},"READ"===this.props.accessLevel&&"\uf00c")),u.a.createElement("h4",null,"Read"),u.a.createElement("p",null,"Collaborators can read document and annotations, but not edit.")),u.a.createElement("li",{className:"WRITE",onClick:function(){return e.changeLevel("WRITE")}},u.a.createElement("div",{className:"checked"},u.a.createElement("div",{className:"icon"},"WRITE"===this.props.accessLevel&&"\uf00c")),u.a.createElement("h4",null,"Write"),u.a.createElement("p",null,"Collaborators can read document and annotations, create new annotations, add and reply to comments.")),u.a.createElement("li",{className:"ADMIN",onClick:function(){return e.changeLevel("ADMIN")}},u.a.createElement("div",{className:"checked"},u.a.createElement("div",{className:"icon"},"ADMIN"===this.props.accessLevel&&"\uf00c")),u.a.createElement("h4",null,"Admin"),u.a.createElement("p",null,"Admins can edit document metadata, invite other collaborators, backup and restore, and roll back the edit history."))))}}]),t}(l.Component);var Y=n(281),z=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!1,options:[],selected:null,inputValue:null},n.fetchSuggestions=function(e){n.setState({isLoading:!0}),d.a.get("/api/sharing/search?q=".concat(e)).then(function(e){return n.setState({isLoading:!1,options:e.data.filter(function(e){return!n.props.exclude.includes(e)})})})},n.onChange=function(e){n.setState({selected:e})},n.onInputChange=function(e){n.setState({inputValue:e})},n.clear=function(){n._input.getInstance().clear(),n.setState({selected:null,inputValue:null})},n.onKeyDown=function(e){var t=n.state,a=t.selected,o=t.inputValue,r=t.options;13===e.which&&(a&&1===a.length?(n.props.onSelect(a[0]),n.clear()):o&&r.includes(o)&&(n.props.onSelect(o),n.clear()))},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement(Y.AsyncTypeahead,{id:"add-collaborator-input",ref:function(t){return e._input=t},className:"autocomplete",placeholder:"Enter username",selected:this.state.selected,onChange:this.onChange,onInputChange:this.onInputChange,onKeyDown:this.onKeyDown,isLoading:this.state.isLoading,onSearch:this.fetchSuggestions,options:this.state.options})}}]),t}(l.Component),X=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={collaborators:[]},n.storeCollaborator=function(e){d.a.post("/api/sharing/folders/collaborator",Object(a.a)({},e,{ids:[n.props.item.id]})).catch(function(e){})},n.openPermissionsSelector=function(e,t){!function(e){var t=e.parent,n=document.createElement("div");t.append(n),Object(m.render)(u.a.createElement(G,{accessLevel:e.accessLevel,onChangeLevel:function(t){e.onChangeLevel(t),n.remove()},onCancel:function(){n.remove()}}),n)}({parent:("BUTTON"===e.target.nodeName?e.target:e.target.parentNode).parentNode,accessLevel:t.access_level,onChangeLevel:function(e){var a={username:t.username,access_level:e};n.storeCollaborator(a),n.setState(function(e){return{collaborators:e.collaborators.map(function(e){return e.username===t.username?a:e})}})}})},n.removeCollaborator=function(e){n.setState(function(t){return{collaborators:t.collaborators.filter(function(t){return t.username!==e.username})}}),d.a.delete("/api/sharing/folders/collaborator",{data:{ids:[n.props.item.id],username:e.username}}).catch(function(e){})},n.addCollaborator=function(e){var t={username:e,access_level:"READ"};n.storeCollaborator(t),n.setState(function(e){return{collaborators:Object(H.a)(e.collaborators).concat([t])}})},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.a.get("/api/sharing/folders/".concat(this.props.item.id,"/collaborators")).then(function(t){e.setState({collaborators:t.data.collaborators})})}},{key:"render",value:function(){var e=this,t=this.state.collaborators.map(function(t){return u.a.createElement("tr",{key:t.username},u.a.createElement("td",null,t.username),u.a.createElement("td",null,u.a.createElement("button",{className:"btn small permissions",onClick:function(n){return e.openPermissionsSelector(n,t)}},u.a.createElement("span",{className:"label"},t.access_level),u.a.createElement("span",{className:"icon"},"\uf0dd"))),u.a.createElement("td",{className:"col-actions remove-collaborator"},u.a.createElement("button",{className:"nostyle outline-icon",onClick:function(){return e.removeCollaborator(t)}},"\ue897")))});return u.a.createElement("div",{className:"collaborators"},u.a.createElement("div",{className:"multi-share-section"},u.a.createElement("h3",null,"Collaborators"),u.a.createElement("table",{className:"collaborators"},u.a.createElement("tbody",null,t.length>0?t:u.a.createElement("tr",{className:"no-collaborators"},u.a.createElement("td",null,"There are no collaborators yet. Enter a username below to add one."))))),u.a.createElement("div",{className:"multi-share-section add-collaborator"},u.a.createElement(z,{exclude:this.state.collaborators.map(function(e){return e.username}),onSelect:this.addCollaborator})))}}]),t}(l.Component),q=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={view:"PUBLIC_ACCESS"},n.onKeydown=function(e){e.stopPropagation(),27===e.which&&n.props.onClose()},n.setView=function(e){n.setState({view:e})},n.renderPublicAccess=function(){return u.a.createElement(B,{item:n.props.selection.get(0)})},n.renderCollaborators=function(){return u.a.createElement(X,{item:n.props.selection.get(0)})},n.getView=function(){return"PUBLIC_ACCESS"===n.state.view?n.renderPublicAccess():"COLLABORATORS"===n.state.view?n.renderCollaborators():void 0},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"render",value:function(){var e=this;return u.a.createElement(L.a,{className:"multi-share-modal",title:"Share",onClose:this.props.onClose},u.a.createElement("div",{className:"multi-share"},u.a.createElement("div",{className:"multi-share-tabs"},u.a.createElement("ul",null,u.a.createElement("li",{className:"PUBLIC_ACCESS"===this.state.view?"active":"",onClick:function(){return e.setView("PUBLIC_ACCESS")}},"Public Access"),u.a.createElement("li",{className:"COLLABORATORS"===this.state.view?"active":"",onClick:function(){return e.setView("COLLABORATORS")}},"Collaborators"),u.a.createElement("li",{className:"disabled"},"Distribute Copies"))),u.a.createElement("div",{className:"multi-share-body"},u.a.createElement("div",{className:"view-container"},this.getView()),u.a.createElement("div",{className:"footer"},u.a.createElement("button",{className:"btn",onClick:this.props.onClose},"Done")))))}}]),t}(l.Component),J={createFolder:function(){return new Promise(function(e){var t=document.createElement("div");document.body.appendChild(t),Object(m.render)(u.a.createElement(y,{onOk:function(n){var a=document.location.hash.substring(1);d.a.post("/api/folder",{title:n||"Unnamed Folder",parent:a}).then(function(){t.remove(),e()})},onCancel:function(){t.remove(),e()}}),t)})},renameFolder:function(e,t){return d.a.put("/api/folder/".concat(e.id,"?title=").concat(t))},uploadFiles:I,importSource:function(e,t){var n=e||function(e){return e.includes("request=GetPassage")?"CTS":"IIIF"}(t);return"SHINE"===e?new Promise(function(e){var t=document.createElement("div");document.body.appendChild(t);var n=function(n){t.remove(),e(n)};Object(m.render)(u.a.createElement(_,{onClose:n,onUploadFiles:n}),t)}).then(function(e){if(e)return I(e)}):t?A([],{url:t,sourceType:n}):new Promise(function(e){var t=document.createElement("div");document.body.appendChild(t);var n=function(n){t.remove(),e(n)};Object(m.render)(u.a.createElement(D,{onOk:n,onCancel:function(){return n()}}),t)}).then(function(e){if(e)return A([],{url:e,sourceType:n})})},updateReadme:function(e,t){return d.a.post(U(),{data:e}).then(function(){return Object(a.a)({},t,{readme:e})})},deleteReadme:function(e){return d.a.delete(U()).then(function(){return Object(a.a)({},e,{readme:null})})},deleteSelection:function(e){var t=e.selection,n=e.view,a=e.onStart,o=e.onSuccess,r=e.onError,s=e.onCancel;!function(e){var t=document.createElement("div");t.setAttribute("id","confirm-prompt-root"),document.body.append(t),Object(m.render)(u.a.createElement(V,{title:e.title,type:e.type,message:e.message,onYes:function(){t.remove(),e.onConfirm()},onNo:function(){t.remove(),e.onCancel&&e.onCancel()}}),t)}({title:"Delete",message:"MY_DOCUMENTS"===n?"You are about to permanently delete the selected documents. Are you sure?":"This will remove the selected documents from your shared documents list. Are you sure?",type:"WARNING",onConfirm:function(){var e=t.getItems().filter(function(e){return"FOLDER"===e.type}),i=t.getItems().filter(function(e){return"DOCUMENT"===e.type});e.length+i.length>0?(a(),function(e,t){var n=e.map(function(e){return e.id});return n.length>0?1===n.length?"MY_DOCUMENTS"===t?d.a.delete("/api/document/".concat(n[0])):d.a.delete("/api/shared/document/".concat(n[0])):"MY_DOCUMENTS"===t?d.a.delete("/api/document/bulk",{data:n}):d.a.delete("/api/shared/document/bulk",{data:n}):new Promise(function(e){e()})}(i,n).then(function(){return function(e){var t=e.map(function(e){return e.id});return t.length>0?1===t.length?d.a.delete("/api/folder/".concat(t[0])):d.a.delete("/api/folder/bulk",{data:t}):new Promise(function(e){e()})}(e)}).then(function(){o()}).catch(function(e){r(e)})):s&&s()},onCancel:s})},duplicateSelection:function(e){if(e.isSingleDocument()){var t=e.get(0);return d.a.post("/api/clone/document/".concat(t.id)).catch(function(e){!function(e){var t=document.createElement("div");t.setAttribute("id","alert-root"),document.body.append(t),Object(m.render)(u.a.createElement(W,{title:e.title,type:e.type,message:e.message,onClose:function(){t.remove(),e.onClose&&e.onClose()}}),t)}({title:"Error",type:"WARNING",message:409===e.response.status?"Oops. Could not duplicate - storage quota exceeded.":"Oops. Something went wrong."})})}return new Promise(function(e){e()})},shareSelection:function(e){return new Promise(function(t){var n=document.createElement("div");document.body.appendChild(n),Object(m.render)(u.a.createElement(q,{selection:e,onClose:function(e){n.remove(),t()}}),n)})},entityRecognition:function(e){return new Promise(function(t){var n=document.createElement("div");document.body.appendChild(n);var a=function(){n.remove()};Object(m.render)(u.a.createElement(P,{selection:e,onCancel:a,onClose:a,onComplete:function(){t()}}),n)})}},Q=n(67),Z=n(98),$=n(85),ee=n(39),te=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).onMousedown=n.onMousedown.bind(Object(ee.a)(Object(ee.a)(n))),n.onKeydown=n.onKeydown.bind(Object(ee.a)(Object(ee.a)(n))),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMousedown,!1),document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMousedown,!1),document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"onMousedown",value:function(e){!this._node.contains(e.target)&&this.props.onCancel()}},{key:"onKeydown",value:function(e){27===e.which&&this.props.onCancel()}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{ref:function(t){return e._node=t},className:"modal-menu ".concat(this.props.className)},u.a.createElement("ul",null,this.props.children))}}]),t}(l.Component);te.Group=function(e){var t=e.className?["group",e.className]:["group"];return u.a.createElement("li",{className:t.join(" ")},u.a.createElement("ul",null,e.children))},te.Item=function(e){return u.a.createElement("li",{key:e.label,className:"option".concat(e.disabled?" disabled":""),onClick:e.disabled||!e.onSelect?null:e.onSelect},e.link?u.a.createElement("a",{href:e.link},e.icon&&u.a.createElement("span",{className:"icon"},e.icon)," ",e.label):u.a.createElement("span",null,e.icon&&u.a.createElement("span",{className:"icon"},e.icon)," ",e.label))};var ne=te,ae={searchIn:"ALL",docType:"ANY",owner:"",metadataContains:null,lastModified:"ANYTIME"},oe=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).onChangeSearchIn=function(e){return n.setState({searchIn:e.target.value})},n.onChangeDocType=function(e){return n.setState({docType:e.target.value})},n.onChangeOwner=function(e){return n.setState({owner:e.target.value})},n.onChangeLastModified=function(e){return n.setState({lastModified:e.target.value})},n.onClear=function(e){e.preventDefault(),n.setState(Object(a.a)({},ae))},n.onSearch=function(e){e.preventDefault(),n.props.onSearch(n.state)},n.state=Object(a.a)({},ae),n.onMousedown=n.onMousedown.bind(Object(ee.a)(Object(ee.a)(n))),n.onKeydown=n.onKeydown.bind(Object(ee.a)(Object(ee.a)(n))),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMousedown,!1),document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMousedown,!1),document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"onMousedown",value:function(e){var t=!this._node.contains(e.target),n=e.target.classList.contains("advanced");t&&!n&&this.props.onClose()}},{key:"onKeydown",value:function(e){27===e.which&&this.props.onClose()}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{ref:function(t){return e._node=t},className:"advanced-search"},u.a.createElement("button",{className:"close nostyle",onClick:this.props.onClose},"\ue897"),u.a.createElement("form",null,u.a.createElement("fieldset",null,u.a.createElement("p",null,u.a.createElement("label",null,"Search in"),u.a.createElement("select",{value:this.state.searchIn,onChange:this.onChangeSearchIn},u.a.createElement("option",{value:"ALL"},"All of Recogito"),u.a.createElement("option",{value:"MY"},"My documents"),u.a.createElement("option",{value:"SHARED"},"Shared with me")),u.a.createElement("span",{className:"hint"})),u.a.createElement("p",null,u.a.createElement("label",null,"Document type"),u.a.createElement("select",{value:this.state.docType,onChange:this.onChangeDocType},u.a.createElement("option",{value:"ANY"},"Any"),u.a.createElement("option",{value:"TEXT"},"Text"),u.a.createElement("option",{value:"IMAGE"},"Image"),u.a.createElement("option",{value:"TABLE"},"Table")),u.a.createElement("span",{className:"hint"})),u.a.createElement("p",null,u.a.createElement("label",null,"Owner"),u.a.createElement("select",{value:this.state.owner,onChange:this.onChangeOwner},u.a.createElement("option",{value:""},"Anyone"),u.a.createElement("option",{value:this.props.account.username},"me")),u.a.createElement("span",{className:"hint"})),u.a.createElement("p",null,u.a.createElement("label",null,"Metadata contains"),u.a.createElement("input",{type:"text"}),u.a.createElement("span",{className:"hint"})),u.a.createElement("p",null,u.a.createElement("label",null,"Last modified"),u.a.createElement("select",{value:this.state.lastModified,onChange:this.onChangeLastModified},u.a.createElement("option",{value:"ANYTIME"},"Any time"),u.a.createElement("option",{value:"WEEK"},"this week")),u.a.createElement("span",{className:"hint"}))),u.a.createElement("fieldset",{className:"buttons"},u.a.createElement("button",{className:"nostyle clear",onClick:this.onClear},"Clear"),u.a.createElement("button",{className:"btn",onClick:this.onSearch},"Search"))))}}]),t}(l.Component),re=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={advancedSearchOpen:!1},n.toggleAdvancedSearch=function(){n.setState(function(e){return{advancedSearchOpen:!e.advancedSearchOpen}})},n.search=function(e){var t=e.target.value;t.length>1&&d.a.post("/api/search/all?q=".concat(t),n.props.displayConfig).then(function(e){n.props.onResponse(e.data)})},n.advancedSearch=function(e){console.log(e)},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"wrapper"},u.a.createElement("div",{className:"search"},u.a.createElement("div",{className:"wrapper"},u.a.createElement("input",{placeholder:"Search Recogito...",onChange:this.search}),u.a.createElement("button",{className:"icon nostyle advanced",onClick:this.toggleAdvancedSearch.bind(this)},"\ue688")),u.a.createElement("span",{className:"icon hand-lens"},"\uf002")),this.state.advancedSearchOpen&&u.a.createElement(oe,{account:this.props.account,onSearch:this.advancedSearch,onClose:this.toggleAdvancedSearch}))}}]),t}(l.Component),se=function(e){var t=e.selection.isSingleDocument()&&"MY_DOCUMENTS"===e.view,n=e.selection.isSingleFolder()&&"MY_DOCUMENTS"===e.view;return u.a.createElement(ne,{className:"selection-options-menu",onCancel:e.onCancel},u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{label:"Open",disabled:!e.selection.isSingleSelection(),link:e.selection.isSingleSelection()&&"document/".concat(e.selection.get(0).id,"/part/1/edit")}),u.a.createElement(ne.Item,{label:"Open in new tab",disabled:!e.selection.isSingleDocument(),onSelect:function(){window.open("document/".concat(e.selection.get(0).id,"/part/1/edit"),"_blank"),e.onCancel()}})),u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf114",label:"Move to",disabled:!0}),u.a.createElement(ne.Item,{icon:"\uf0c5",label:"Duplicate",disabled:!t,onSelect:e.onDuplicateSelection}),u.a.createElement(ne.Item,{icon:"\uf014",label:"Delete",onSelect:e.onDeleteSelection})),u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf234",label:"Share",disabled:!n,onSelect:e.onShareSelection})),u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf085",label:"Named Entity Recognition",disabled:!e.selection.includesText(),onSelect:e.onNER})))},ie=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={optionsMenuVisible:!1},n.showOptionsMenu=function(){n.setState({optionsMenuVisible:!0})},n.closeOptionsMenu=function(){n.setState({optionsMenuVisible:!1})},n.closeAndThen=function(e){return function(t){n.setState({optionsMenuVisible:!1}),e(t)}},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=!this.props.selection.isEmpty();return u.a.createElement("div",{className:this.props.readme?"header":"header no-readme"},u.a.createElement("div",{className:"top-row"},u.a.createElement(re,{account:this.props.account,tableConfig:this.props.tableConfig,onResponse:this.props.onSearchResponse}),u.a.createElement("div",{className:"header-icons"},u.a.createElement($.a,{icon:"\ue64a",className:"help stroke7",link:"/help"}))),u.a.createElement("div",{className:"main-header"},u.a.createElement(Z.a,{view:this.props.view,path:this.props.breadcrumbs,docCount:this.props.docCount},!this.props.readme&&"MY_DOCUMENTS"===this.props.view&&u.a.createElement("button",{className:"add-abstract nostyle",onClick:this.props.onCreateReadme},u.a.createElement("span",{className:"icon"},"\uf055"),u.a.createElement("span",{className:"label"},"Add a description..."))),u.a.createElement("div",{className:"main-header-icons"},u.a.createElement(Q.CSSTransition,{in:e,timeout:200,classNames:"selection-options"},u.a.createElement("div",{className:"selection-options",onClick:this.showOptionsMenu},u.a.createElement("span",{className:"label"},"Options"),u.a.createElement("span",{className:"more icon"},"\uf078"))),this.state.optionsMenuVisible&&u.a.createElement(se,{view:this.props.view,selection:this.props.selection,onDuplicateSelection:this.closeAndThen(this.props.onDuplicateSelection),onDeleteSelection:this.closeAndThen(this.props.onDeleteSelection),onShareSelection:this.closeAndThen(this.props.onShareSelection),onNER:this.closeAndThen(this.props.onNER),onCancel:this.closeOptionsMenu}),u.a.createElement($.a,{className:"presentation-toggle stroke7",icon:"TABLE"===this.props.presentation?"\ue645":"\ue636",onClick:this.props.onTogglePresentation}))))}}]),t}(l.Component),ce=n(99),le=n(100),ue=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={menuVisible:!1},n.openMenu=function(){n.setState({menuVisible:!0})},n.closeMenu=function(){n.setState({menuVisible:!1})},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"section account",onClick:this.openMenu},u.a.createElement(le.a,{account:this.props.account}),this.state.menuVisible&&u.a.createElement(ne,{className:"account-menu",onCancel:this.closeMenu},u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf0ad",label:"Account settings",link:"/settings/account"})),u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf128",label:"Help",link:"/help"}),u.a.createElement(ne.Item,{icon:"\uf011",label:"Sign out",link:"/logout"}))))}}]),t}(l.Component),me=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={menuVisible:!1},n.onOpenMenu=function(){n.setState({menuVisible:!0})},n.onCloseMenu=function(){n.setState({menuVisible:!1})},n.onOpenFileExplorer=function(){n._input.click()},n.onUploadFiles=function(e){var t=Array.from(e.target.files);n.props.onUploadFiles(t)},n.select=function(e){return function(){n.setState({menuVisible:!1}),e()}},n.hasFeature=function(e){return n.props.account.feature_toggles&&n.props.account.feature_toggles.includes(e)},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"section create-new"},u.a.createElement("button",{className:"btn create-new",onClick:this.onOpenMenu},u.a.createElement("span",{className:"icon"},"\uf067"),u.a.createElement("span",{className:"label"},"New")),u.a.createElement("input",{ref:function(t){return e._input=t},type:"file",name:"file",multiple:!0,onChange:this.onUploadFiles,style:{display:"none"}}),this.state.menuVisible&&u.a.createElement(ne,{className:"create-new",onCancel:this.onCloseMenu},u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf07b",label:"Folder",onSelect:this.select(this.props.onCreateFolder)}),u.a.createElement(ne.Item,{icon:"\uf15b",label:"File upload",onSelect:this.select(this.onOpenFileExplorer)})),u.a.createElement(ne.Group,null,u.a.createElement(ne.Item,{icon:"\uf0c1",label:"From IIIF manifest",onSelect:this.select(function(){return e.props.onImportSource("IIIF")})}),u.a.createElement(ne.Item,{icon:"\uf121",label:"From CTS service",onSelect:this.select(function(){return e.props.onImportSource("CTS")})}),this.hasFeature("rise")&&u.a.createElement(ne.Item,{icon:"\uf0f6",label:"From SHINE repository",onSelect:this.select(function(){return e.props.onImportSource("SHINE")})}))))}}]),t}(l.Component),pe=function(e){return u.a.createElement("li",{className:e.current?"current":null,onClick:e.onClick},u.a.createElement("span",{className:"icon"},e.icon)," ",e.children)},de=function(e){return u.a.createElement("div",{className:"section views"},u.a.createElement("ul",null,u.a.createElement(pe,{icon:"\uf2be",current:"MY_DOCUMENTS"===e.view,onClick:function(){return e.onChangeView("MY_DOCUMENTS")}},"My Documents"),u.a.createElement(pe,{icon:"\uf064",current:"SHARED_WITH_ME"===e.view,onClick:function(){return e.onChangeView("SHARED_WITH_ME")}},"Shared with me")))},he=n(46),fe=n.n(he),ve=function(e){var t=e.account&&e.account.storage,n=t?e.account.storage.quota_mb:0,a=t?e.account.storage.used_mb:0;return u.a.createElement("div",{className:"section storage"},u.a.createElement("span",{className:"icon"},"\uf1c0")," Storage",u.a.createElement("div",{className:"used-diskspace"},u.a.createElement(C,{value:n>0?Math.min(1,a/n):0}),u.a.createElement("div",{className:"label"},u.a.createElement(fe.a,{displayType:"text",value:a,thousandSeparator:!0})," of  ",u.a.createElement(fe.a,{displayType:"text",value:n,thousandSeparator:!0})," MB used")))},be=n(101),Ee=n(102),ge=function(e){return u.a.createElement(u.a.Fragment,null,u.a.createElement(be.a,{className:"section",width:237,height:55,fill:"#4483c4",stats:e.account&&e.account.stats}),u.a.createElement(Ee.a,{className:"section collaborators",title:"My top collaborators",username:e.account&&e.account.username}))},ye=function(e){return u.a.createElement("div",{className:"sidebar"},u.a.createElement(ue,{account:e.account}),u.a.createElement(me,{account:e.account,onCreateFolder:e.onCreateFolder,onUploadFiles:e.onUploadFiles,onImportSource:e.onImportSource}),u.a.createElement(de,{view:e.view,onChangeView:e.onChangeView}),u.a.createElement(ve,{account:e.account}),u.a.createElement(ge,{account:e.account}))},Ce=n(104),Oe=n(103),ke=function(e){return u.a.createElement(u.a.Fragment,null,u.a.createElement(ye,{account:e.account,view:e.view,onChangeView:e.onChangeView,onCreateFolder:e.onCreateFolder,onUploadFiles:e.onUploadFiles,onImportSource:e.onImportSource}),u.a.createElement("div",{className:"main-content"},u.a.createElement(ie,{account:e.account,view:e.view,presentation:e.presentation,readme:e.page.readme,breadcrumbs:e.page.breadcrumbs,docCount:e.page.total_count,selection:e.selection,onTogglePresentation:e.onTogglePresentation,onCreateReadme:e.onCreateReadme,onDuplicateSelection:e.onDuplicateSelection,onDeleteSelection:e.onDeleteSelection,onShareSelection:e.onShareSelection,onNER:e.onNER,onSearchResponse:e.onSearchResponse}),e.page.readme&&u.a.createElement(ce.a,{content:e.page.readme,onUpdate:e.onUpdateReadme,onDelete:e.onDeleteReadme}),"TABLE"===e.presentation&&u.a.createElement(Oe.a,{items:e.page.items,config:e.tableConfig,selection:e.selection,busy:e.busy,enableFiledrop:"MY_DOCUMENTS"===e.view,onSelect:e.onSelect,onSort:e.onSortTable,onChangeColumnConfig:e.onChangeColumnConfig,onRenameFolder:e.onRenameFolder,onDropFiles:e.onUploadFiles,onDropSourceURL:function(t){return e.onImportSource(null,t)}}),"GRID"===e.presentation&&u.a.createElement(Ce.a,{items:e.page.items,selection:e.selection,busy:e.busy,enableFiledrop:"MY_DOCUMENTS"!==e.view,onSelect:e.onSelect,onDropFiles:e.onUploadFiles,onDropSourceURL:function(t){return e.onImportSource(null,t)}})))};n(657);n.d(t,"default",function(){return Se});var Se=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).onKeydown=function(e){27===e.which?n.setState({selection:new f.a}):46!==e.which||n.state.selection.isEmpty()||n.deleteSelection()},n.onMousedown=function(e){!(document.querySelector(".documents-pane").contains(e.target)||document.querySelector(".main-header-icons").contains(e.target))&&n.setState({selection:new f.a})},n.refreshPage=function(){n.setState({busy:!0});var e=document.location.hash.substring(1),t="MY_DOCUMENTS"===n.state.view?e?"my/".concat(e):"my":e?"my/shared/".concat(e):"my/shared",o="GRID"===n.state.presentation?null:{columns:h.b.expandAggregatedColumns(n.state.table_config.columns),sort:n.state.table_config.sorting};return d.a.post("/api/directory/".concat(t),o).then(function(e){n.setState(function(t){var n=e.data,o=n.breadcrumbs,r=n.readme,s=n.total_count,i=n.items;return{page:Object(a.a)({},t.page,{breadcrumbs:o,readme:r,total_count:s,items:i}),busy:!1}})})},n.changeFolder=function(){n.setState({selection:new f.a},function(){n.refreshPage()})},n.changeView=function(e){E("view",e),n.setState({view:e},n.refreshPage)},n.togglePresentation=function(){n.setState(function(e){var t="TABLE"===e.presentation?"GRID":"TABLE";return E("presentation",t),{presentation:t}})},n.select=function(e){n.setState({selection:e})},n.sortTable=function(e){n.setState(function(t){var n=Object(a.a)({},t.table_config,{sorting:e});return E("table_config",n),{table_config:n}},function(){n.refreshPage()})},n.changeColumConfig=function(e){n.setState(function(t){var n=Object(a.a)({},t.table_config,{columns:e});return E("table_config",n),{table_config:n}})},n.createReadme=function(){n.setState(function(e){return{page:Object(a.a)({},e.page,{readme:!0})}})},n.updateReadme=function(e){J.updateReadme(e,n.state.page).then(function(e){n.setState({page:e})})},n.deleteReadme=function(){J.deleteReadme(n.state.page).then(function(e){n.setState({page:e})})},n.duplicateSelection=function(){n.setState({busy:!0}),J.duplicateSelection(n.state.selection).then(n.refreshPage)},n.deleteSelection=function(){J.deleteSelection({selection:n.state.selection,view:n.state.view,onStart:function(){return n.setState({busy:!0})},onSuccess:n.refreshPage,onError:n.refreshPage})},n.onSearchResponse=function(e){n.setState(function(t){return{view:"SEARCH",page:{breadcrumbs:null,readme:null,total_count:e.total,items:e.items}}})},n.state=b(),n._rootEl=document.getElementById("app"),window.onhashchange=n.changeFolder,n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._rootEl.addEventListener("keydown",this.onKeydown,!1),this._rootEl.addEventListener("mousedown",this.onMousedown,!1),d.a.get("/api/account/my").then(function(t){e.setState({account:t.data})}).then(function(){e.refreshPage()})}},{key:"componentWillUnmount",value:function(){this._rootEl.removeEventListener("keydown",this.onKeydown,!1),this._rootEl.removeEventListener("mousedown",this.onMousedown,!1)}},{key:"render",value:function(){var e=this;return u.a.createElement(ke,{account:this.state.account,view:this.state.view,presentation:this.state.presentation,page:this.state.page,tableConfig:this.state.table_config,selection:this.state.selection,busy:this.state.busy,onChangeView:this.changeView,onTogglePresentation:this.togglePresentation,onSelect:this.select,onSortTable:this.sortTable,onChangeColumnConfig:this.changeColumConfig,onCreateReadme:this.createReadme,onUpdateReadme:this.updateReadme,onDeleteReadme:this.deleteReadme,onCreateFolder:function(){return J.createFolder().then(e.refreshPage)},onRenameFolder:function(t,n){return J.renameFolder(t,n).then(e.refreshPage)},onDuplicateSelection:this.duplicateSelection,onDeleteSelection:this.deleteSelection,onShareSelection:function(){return J.shareSelection(e.state.selection)},onNER:function(){return J.entityRecognition(e.state.selection).then(e.refreshPage)},onSearchResponse:this.onSearchResponse,onUploadFiles:function(t){return J.uploadFiles(t).then(e.refreshPage)},onImportSource:function(t,n){return J.importSource(t,n).then(e.refreshPage)}})}}]),t}(l.Component);Object(m.render)(u.a.createElement(Se,null),document.getElementById("app"))},85:function(e,t,n){"use strict";var a=n(0),o=n.n(a);t.a=function(e){return o.a.createElement("div",{className:"header-icon ".concat(e.className),onClick:e.onClick},e.link?o.a.createElement("a",{href:e.link,className:"icon inner"},e.icon):o.a.createElement("span",{className:"icon inner"},e.icon))}},98:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r={MY_DOCUMENTS:"My Documents",SHARED_WITH_ME:"Shared with me",SEARCH:"Search results"};t.a=function(e){var t=e.view?r[e.view]:e.label;return o.a.createElement("div",{className:"breadcrumbs"},o.a.createElement("h2",null,o.a.createElement("a",{className:"root",href:"#"},t),e.path&&e.path.map(function(e){return o.a.createElement("a",{className:"folder",href:"#".concat(e.id),key:e.id},e.title)})),null!==e.docCount&&void 0!==e.docCount&&o.a.createElement("span",{className:"count"},"(".concat(e.docCount,")")),e.children)}},99:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n(4),o=n(5),r=n(7),s=n(3),i=n(6),c=n(0),l=n.n(c),u=n(135),m=n.n(u),p=n(136),d={editing:!1,modifiedContent:null},h=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(n=Object(r.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={},n.onKeydown=function(e){27===e.which?n.onCancel():e.ctrlKey&&13===e.which&&n.onSave()},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"onEdit",value:function(){document.addEventListener("keydown",this.onKeydown,!1),this.setState({editing:!0})}},{key:"onChange",value:function(e,t){this.setState({modifiedContent:t})}},{key:"onDelete",value:function(){document.removeEventListener("keydown",this.onKeydown,!1),this.props.onDelete&&this.props.onDelete()}},{key:"onSave",value:function(){document.removeEventListener("keydown",this.onKeydown,!1),this.props.onUpdate&&this.props.onUpdate(this.state.modifiedContent),this.setState(d)}},{key:"onCancel",value:function(){document.removeEventListener("keydown",this.onKeydown,!1),"boolean"===typeof this.props.content?this.onDelete():this.setState(d)}},{key:"renderView",value:function(e){return l.a.createElement("div",{className:"readme"},l.a.createElement("div",{className:"wrapper"},l.a.createElement("div",{className:"textbox"},l.a.createElement(m.a,{source:e})),this.props.onUpdate&&this.props.onDelete&&l.a.createElement("span",{className:"buttons modify"},l.a.createElement("button",{className:"icon nostyle",title:"Edit",onClick:this.onEdit.bind(this)},"\uf040"))))}},{key:"renderEdit",value:function(e){return l.a.createElement("div",{className:"readme editing"},l.a.createElement("div",{className:"wrapper"},l.a.createElement(p.a,{tagName:"div",className:"textbox",content:e,editable:!0,multiLine:!0,onChange:this.onChange.bind(this)}),l.a.createElement("div",{className:"editbar"},l.a.createElement("span",{className:"hint"},"Supports styling with ",l.a.createElement("a",{href:"# "},"Markdown")),l.a.createElement("span",{className:"buttons"},l.a.createElement("button",{className:"label nostyle",onClick:this.onDelete.bind(this)},"Delete description"),l.a.createElement("button",{className:"icon nostyle",onClick:this.onSave.bind(this)},"\uf00c"),l.a.createElement("button",{className:"icon nostyle",onClick:this.onCancel.bind(this)},"\uf00d")))))}},{key:"render",value:function(){var e="boolean"===typeof this.props.content;e&&document.addEventListener("keydown",this.onKeydown,!1);var t=e?"":this.state.modifiedContent?this.state.modifiedContent:this.props.content;return this.state.editing||e?this.renderEdit(t):this.renderView(t)}}]),t}(c.Component)}},[[307,4,0,3]]]);
//# sourceMappingURL=workspace.078d6a07.chunk.js.map